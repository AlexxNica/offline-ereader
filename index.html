<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="description" content="A responsive, offline eReader built with Polymer.">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
    <meta theme-color="#0277db">

    <title>My Library</title>

    <link rel="manifest" href="manifest.json">
    <link rel="shortcut icon" href="images/icon.png">

    <script src="bower_components/platform/platform.js"></script>
    <script src="bower_components/es6-shim/es6-shim.min.js"></script>
    <link rel="import" href="bower_components/core-header-panel/core-header-panel.html">
    <link rel="import" href="bower_components/core-icon-button/core-icon-button.html">
    <link rel="import" href="bower_components/core-image/core-image.html">
    <link rel="import" href="bower_components/core-toolbar/core-toolbar.html">
    <link rel="import" href="bower_components/font-roboto/roboto.html">
    <link rel="import" href="bower_components/paper-button/paper-button.html">
    <link rel="import" href="bower_components/paper-dialog/paper-dialog.html">
    <link rel="import" href="bower_components/paper-dialog/paper-dialog-transition.html">
    <link rel="import" href="bower_components/paper-input/paper-input.html">
    <link rel="import" href="bower_components/paper-item/paper-item.html">
    <link rel="import" href="bower_components/paper-menu-button/paper-menu-button.html">
    <link rel="import" href="bower_components/paper-radio-group/paper-radio-group.html">
    <link rel="import" href="bower_components/paper-ripple/paper-ripple.html">

    <link rel="stylesheet" href="styles/common.css" shim-shadowdom>
    <link rel="stylesheet" href="styles/index.css" shim-shadowdom>
  </head>

  <body unresolved fullbleed layout vertical>
    <template is="auto-binding" id="page-template">
      <core-header-panel flex>
        <core-toolbar>
          <div id="page-title" flex>My Library</div>

          <core-icon-button icon="sort"
                            on-tap="{{toggleSortDialog}}">
          </core-icon-button>

          <paper-dialog id="sort-dialog"
                        heading="Sort by"
                        transition="paper-dialog-transition-center">
            <paper-radio-group selected="{{sortOrder}}"
                               on-change="{{toggleSortDialog}}">
              <paper-radio-button name="lastAccessed"
                                  label="Recent">
              </paper-radio-button>
              <paper-radio-button name="title"
                                  label="Title">
              </paper-radio-button>
              <paper-radio-button name="author"
                                  label="Author">
              </paper-radio-button>
            </paper-radio-group>
          </paper-dialog>

          <core-icon-button icon="add"
                            on-tap="{{toggleAddDialog}}">
          </core-icon-button>

          <paper-dialog id="add-dialog"
                        heading="Add to library"
                        transition="paper-dialog-transition-center">
            <paper-input label="Title"
                         value="{{toBeAddedTitle}}"
                         autofocus
                         required>
            </paper-input>
            <paper-input label="Author"
                         value="{{toBeAddedAuthor}}">
            </paper-input>
            <paper-input label="Text URL"
                         value="{{toBeAddedUrl}}"
                         type="url"
                         required>
            </paper-input>
            <paper-input label="Cover URL"
                         value="{{toBeAddedCover}}"
                         type="url">
            </paper-input>
            <paper-button dismissive autofocus>Cancel</paper-button>
            <paper-button affirmative on-tap="{{addBook}}">Add</paper-button>
          </paper-dialog>
        </core-toolbar>

        <div id="book-list" fit layout horizontal wrap center-justified>
          <template repeat="{{book, i in books}}">
            <div class="book"
                 on-click="{{readBook}}">
              <paper-ripple fit></paper-ripple>

              <core-image class="cover"
                          src="{{book.cover}}"
                          preload
                          fade
                          sizing="crop">
              </core-image>

              <div class="book-bottom">
                <div class="text" layout vertical>
                  <div class="title">{{book.title}}</div>
                  <div class="author">{{book.author}}</div>
                </div>

                <paper-menu-button icon="more-vert">
                  <paper-item>Download</paper-item>
                  <paper-item on-tap="{{toggleRemoveDialog}}">Delete from library</paper-item>
                  <paper-item>Edit info</paper-item>
                </paper-menu-button>
              </div>
            </div>
          </template>

          <paper-dialog id="remove-dialog"
                        heading="Delete from library?"
                        transition="paper-dialog-transition-center">
            <p class="title">{{toBeRemoved.book.title}}</p>
            <p>This book will be removed from the list of available books.</p>
            <paper-button dismissive autofocus>Cancel</paper-button>
            <paper-button affirmative on-tap="{{removeBook}}">Delete</paper-button>
          </paper-dialog>
        </div>
      </core-header-panel>
    </template>

    <script src="js/index.js"></script>
  </body>
</html>
